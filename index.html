<!DOCTYPE html>
<html lang="da" data-theme="dark">
<head>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIRAS Ventilationsberegner_v0.13.1_dev</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="manifest" href="manifest.json">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');

        :root {
            /* NIRAS Future Vibe - Neon Inspired */
            --primary-neon-blue: #00E4FF;
            --secondary-neon-purple: #B200FF;
            --accent-neon-green: #39FF14;
            --text-color: #E0E0E0;
            --text-muted-color: #A0A0A0;
            --background-color: #1A1A2E;
            --content-bg-color: #16213E;
            --border-color: #334257;
            --input-bg-color: #0F0F1A;
            --error-color: #FF69B4;
            --niras-red: #D22137;
            --card-shadow-glow: 0 0 8px var(--primary-neon-blue), 0 0 15px var(--primary-neon-blue);
            --input-shadow-glow: 0 0 5px var(--primary-neon-blue);
            --button-shadow-glow: 0 0 10px var(--accent-neon-green);
            --radio-checked-shadow: 0 0 8px var(--secondary-neon-purple);
        }
        
        html[data-theme="light"] {
            /* NIRAS Standard Light Theme */
            --primary-color: #00A4E0;
            --secondary-color: #E5F6FD;
            --accent-color: #78BE20; /* Grøn til knapper i Light Mode */
            --text-color: #212529;
            --text-muted-color: #6c757d;
            --background-color: #F8F9FA;
            --content-bg-color: #FFFFFF;
            --border-color: #DEE2E6;
            --input-bg-color: #FFFFFF; /* Explicitly white background for inputs in light mode */
            --error-color: #D22137;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -2px rgba(0, 0, 0, 0.04);
        }

        body {
            font-family: 'Inter', sans-serif; background-color: var(--background-color); color: var(--text-color);
            display: flex; justify-content: center; align-items: flex-start; min-height: 100vh;
            margin: 0; padding: 20px; box-sizing: border-box; transition: background-color 0.3s, color 0.3s;
        }
        .container { width: 100%; max-width: 650px; }
        .calculator-container {
            background: var(--content-bg-color); border-radius: 16px;
            border: 1px solid var(--border-color);
            transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }
        html[data-theme="light"] .calculator-container { box-shadow: var(--card-shadow); }
        html[data-theme="dark"] .calculator-container { box-shadow: var(--card-shadow-glow); border-color: var(--primary-neon-blue); }
        
        .header { display: flex; justify-content: space-between; align-items: center; padding: 20px 30px 0; }
        .header-controls { display: flex; align-items: center; gap: 15px; }
        .logo { text-align: left; }
        .logo-main {
            font-size: 2.5rem; font-weight: 700; letter-spacing: 2px;
            line-height: 1;
            transition: color 0.3s, text-shadow 0.3s, filter 0.3s;
        }
        .logo-main svg {
            width: 130px; /* Controls the size of the logo */
            height: auto;
            display: block;
        }
        .logo-subtitle {
            font-size: 0.8rem; font-weight: 500; letter-spacing: 1px;
            display: block;
            transition: color 0.3s, text-shadow 0.3s;
        }

        /* Light Mode Logo */
        html[data-theme="light"] .logo-main svg {
            fill: var(--niras-red);
            filter: none;
        }
        html[data-theme="light"] .logo-subtitle {
            color: var(--niras-red);
            text-shadow: none;
        }

        /* Dark Mode Logo */
        html[data-theme="dark"] .logo-main svg {
            fill: var(--secondary-neon-purple); /* Lyserød for NIRAS */
            filter: drop-shadow(0 0 4px var(--secondary-neon-purple)) drop-shadow(0 0 8px var(--secondary-neon-purple));
        }
        html[data-theme="dark"] .logo-subtitle {
            color: var(--primary-neon-blue); /* Lyseblå for Ventilationsberegner */
            text-shadow: 0 0 4px var(--primary-neon-blue), 0 0 8px var(--primary-neon-blue);
        }

        .global-settings { 
            padding: 15px 30px 10px; 
            border-bottom: 1px solid var(--border-color);
        }
        .global-settings .input-group { 
            max-width: 200px; 
            margin-bottom: 0;
        }
        
        .input-with-button { display: flex; align-items: center; gap: 10px; }
        .input-with-button .input-field { flex-grow: 1; }
        .help-button {
            padding: 0; width: 32px; height: 32px; flex-shrink: 0;
            background-color: var(--input-bg-color); border: 1px solid var(--border-color);
            border-radius: 50%; cursor: pointer; font-size: 1.2rem; font-weight: bold;
            color: var(--text-muted-color); transition: all 0.2s;
        }
        .help-button:hover { border-color: var(--primary-color); color: var(--primary-color); }
        html[data-theme="dark"] .help-button:hover { box-shadow: var(--input-shadow-glow); }


        .tab-nav { display: flex; }
        .tab-link {
            flex: 1; padding: 15px; text-align: center; background: none; border: none; font-size: 1rem;
            font-weight: 500; cursor: pointer; color: var(--text-muted-color); border-bottom: 3px solid transparent; transition: all 0.2s;
        }
        .tab-link:hover { background-color: var(--secondary-color); color: var(--primary-color); }
        .tab-link.active { color: var(--primary-color); border-bottom-color: var(--primary-color); font-weight: 700; }
        html[data-theme="dark"] .tab-link.active { text-shadow: 0 0 5px var(--primary-neon-blue); box-shadow: 0 2px 8px -2px var(--primary-neon-blue); }
        
        .tab-content { padding: 30px; }
        .tab-content.hidden { display: none; }
        
        h2 { font-size: 1.4rem; border-bottom: 2px solid var(--border-color); padding-bottom: 10px; margin: 0 0 25px 0; color: var(--primary-color); }
        html[data-theme="dark"] h2 { text-shadow: 0 0 3px var(--primary-neon-blue); }
        label { display: block; margin-bottom: 8px; font-weight: 500; font-size: 0.9rem; color: var(--text-muted-color); }
        .input-group { margin-bottom: 20px; }

        .input-unit-wrapper { position: relative; }
        .input-unit-wrapper::after {
            content: attr(data-unit);
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted-color);
            font-size: 0.9rem;
            pointer-events: none;
        }
        .input-field[type="text"], .input-field[type="number"] {
            padding-right: 50px; /* Make space for the unit */
        }
        
        .input-field, select {
            width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px;
            box-sizing: border-box; font-size: 1rem; background-color: var(--input-bg-color); color: var(--text-color);
            transition: background-color 0.3s, color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }
        html[data-theme="dark"] .input-field { box-shadow: 0 0 3px rgba(var(--primary-neon-blue), 0.3); }
        .input-field:focus, select:focus { border-color: var(--primary-color); outline: none; }
        html[data-theme="light"] .input-field:focus, html[data-theme="light"] select:focus { box-shadow: 0 0 0 3px rgba(0, 164, 224, 0.2); }
        html[data-theme="dark"] .input-field:focus, html[data-theme="dark"] select:focus { box-shadow: var(--input-shadow-glow); }
        .input-field-group { display: grid; gap: 10px; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); }
        .input-field-group > div { flex: 1; }

        .radio-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; border-radius: 8px; padding: 5px; background-color: var(--input-bg-color); transition: background-color 0.3s; border: 1px solid var(--border-color); }
        .radio-group label { text-align: center; padding: 10px; border-radius: 6px; cursor: pointer; transition: background-color 0.3s, color 0.3s, box-shadow 0.3s; font-weight: 500; color: var(--text-color); }
        .radio-group input[type="radio"] { display: none; }
        html[data-theme="light"] .radio-group input[type="radio"]:checked + label { background-color: var(--primary-color); color: white; }
        html[data-theme="dark"] .radio-group input[type="radio"]:checked + label { background-color: var(--secondary-neon-purple); color: white; box-shadow: var(--radio-checked-shadow); text-shadow: 0 0 5px white; }

        /* Primary Button Styling */
        .button.primary { background-color: var(--accent-color); color: var(--background-color); }
        html[data-theme="dark"] .button.primary {
            background-color: var(--secondary-neon-purple); /* Lyserød baggrund i Dark Mode */
            color: white; /* Hvid tekst på lyserød baggrund */
            text-shadow: 0 0 5px rgba(255,255,255,0.7); /* Hvidligt skær på tekst */
        }
        .button.primary:hover { opacity: 0.85; }
        html[data-theme="dark"] .button.primary:hover { box-shadow: var(--button-shadow-glow); }
        
        .button.secondary { background-color: var(--border-color); color: var(--text-color); }
        .button.secondary:hover { opacity: 0.85; }
        html[data-theme="dark"] .button.secondary:hover { box-shadow: 0 0 5px var(--text-muted-color); }
        .button { 
            width: 100%; padding: 15px; border: none; border-radius: 8px; font-size: 1.1rem;
            font-weight: 700; cursor: pointer; transition: opacity 0.2s, box-shadow 0.3s, background-color 0.3s, color 0.3s, text-shadow 0.3s; margin-top: 10px; 
        }
        html[data-theme="dark"] .button:not(.primary) { text-shadow: 0 0 3px rgba(0,0,0,0.5); } /* Just for secondary buttons etc. */

        .results-container { margin-top: 20px; display: grid; gap: 20px; }
        .result-card {
            background: var(--secondary-color); padding: 20px; border-radius: 8px;
            border-left: 5px solid var(--accent-color);
            transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }
        html[data-theme="dark"] .result-card { background-color: var(--content-bg-color); box-shadow: var(--card-shadow-glow); }
        .result-card.error { border-left-color: var(--error-color); }
        html[data-theme="dark"] .result-card.error { box-shadow: 0 0 8px var(--error-color); }
        .result-card h3 { margin-top: 0; margin-bottom: 15px; color: var(--accent-color); display: flex; justify-content: space-between; align-items: center; }
        html[data-theme="dark"] .result-card h3 { text-shadow: 0 0 5px var(--accent-color); }
        .result-card p { margin: 10px 0; font-size: 1rem; line-height: 1.5; color: var(--text-color); }
        .result-card p strong { font-weight: 500; color: var(--primary-color); }
        .highlight { font-size: 1.1rem; font-weight: bold; }

        .comparison-table, .fittings-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .comparison-table th, .comparison-table td, .fittings-table th, .fittings-table td { text-align: left; padding: 10px; border-bottom: 1px solid var(--border-color); color: var(--text-color); }
        .comparison-table th, .fittings-table th { font-weight: 500; color: var(--primary-color); }
        .comparison-table .chosen-row td { font-weight: bold; color: var(--accent-color); }
        .fittings-table tfoot td { font-weight: bold; font-size: 1.1rem; color: var(--accent-color); }
        html[data-theme="dark"] .fittings-table tfoot td { text-shadow: 0 0 3px var(--accent-color); }
        .delete-btn, .details-btn { background: none; border: none; cursor: pointer; font-size: 1.2rem; }
        .delete-btn { color: var(--error-color); }
        html[data-theme="dark"] .delete-btn { text-shadow: 0 0 3px var(--error-color); }
        .details-btn { color: var(--primary-color); font-weight: bold; }
        html[data-theme="dark"] .details-btn { text-shadow: 0 0 3px var(--primary-neon-blue); }
        
        .sub-group { border-left: 3px solid var(--primary-color); padding-left: 15px; margin-top: 15px; }

        .theme-switch-wrapper { display: flex; align-items: center; }
        .theme-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .theme-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--border-color); transition: .4s; border-radius: 26px; }
        html[data-theme="dark"] .slider { box-shadow: 0 0 5px rgba(255,255,255,0.1); }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: var(--content-bg-color); transition: .4s; border-radius: 50%; }
        html[data-theme="dark"] .slider:before { box-shadow: 0 0 8px rgba(255,255,255,0.3); }
        input:checked + .slider { background-color: var(--accent-neon-green); }
        html[data-theme="dark"] input:checked + .slider { box-shadow: 0 0 8px var(--accent-neon-green); }
        input:checked + .slider:before { transform: translateX(24px); }
        .theme-switch-label { color: var(--text-muted-color); font-size: 0.9rem; margin-right: 10px; white-space: nowrap; }
        
        /* Modal for Details */
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto; background-color: rgba(0,0,0,0.7); justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: var(--content-bg-color); margin: auto; padding: 25px; border: 1px solid var(--primary-color);
            width: 90%; max-width: 600px; border-radius: 12px;
        }
        html[data-theme="dark"] .modal-content { box-shadow: var(--card-shadow-glow); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        .modal-header h3 { color: var(--accent-color); margin: 0;}
        html[data-theme="dark"] .modal-header h3 { text-shadow: 0 0 5px var(--accent-color); }
        .close-button { color: var(--text-muted-color); font-size: 28px; font-weight: bold; cursor: pointer; }
        .close-button:hover, .close-button:focus { color: var(--text-color); }
        .modal-body { padding-top: 15px; max-height: 60vh; overflow-y: auto; }
        .modal-body p, .modal-body li { margin: 5px 0; }
        .modal-body strong { color: var(--primary-color); }
        .modal-body code { background-color: var(--border-color); padding: 2px 5px; border-radius: 4px; font-family: monospace; }

        /* Illustration Styles */
        .illustration-container {
            margin: -10px auto 20px auto;
            padding: 10px;
            max-width: 250px;
        }
        .illustration-container svg {
            width: 100%;
            height: auto;
            display: block;
        }
        .illustration-container .line {
            stroke: var(--primary-neon-blue);
            stroke-width: 2.5;
            fill: none;
            stroke-linecap: round;
        }
        .illustration-container .label {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: bold;
            fill: var(--secondary-neon-purple);
            text-shadow: 0 0 3px var(--secondary-neon-purple);
        }
        html[data-theme="light"] .illustration-container .line { stroke: var(--primary-color); }
        html[data-theme="light"] .illustration-container .label { fill: var(--text-color); text-shadow: none; }
        
        .app-footer { text-align: center; padding: 20px 0 0 0; }
        .app-footer p { font-size: 0.8rem; color: var(--text-muted-color); }
    </style>
</head>
<body>
    <div class="container">
        <div class="calculator-container">
            <div class="header">
                <div class="logo">
                    <div class="logo-main">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 10.079999923706055 116.43000030517578 41.190006256103516" data-asc="1.0087890625" width="116.43000030517578" height="41.190006256103516"><defs/><g fill="#000000"><g transform="translate(0, 0)"><path d="M22.95 10.91L22.95 50.44L13.94 50.44L8.59 32.47L8.59 50.44L0 50.44L0 10.91L8.59 10.91L14.36 28.71L14.36 10.91L22.95 10.91ZM37.35 10.91L37.35 50.44L27.08 50.44L27.08 10.91L37.35 10.91ZM41.48 10.91L48.75 10.91Q56.03 10.91 58.61 11.47Q61.18 12.04 62.81 14.34Q64.43 16.65 64.43 21.70Q64.43 26.32 63.28 27.91Q62.13 29.49 58.76 29.81Q61.82 30.57 62.87 31.84Q63.92 33.11 64.17 34.17Q64.43 35.23 64.43 40.01L64.43 50.44L54.88 50.44L54.88 37.30Q54.88 34.13 54.38 33.37Q53.88 32.62 51.76 32.62L51.76 50.44L41.48 50.44L41.48 10.91M51.76 17.68L51.76 26.46Q53.49 26.46 54.19 25.99Q54.88 25.51 54.88 22.90L54.88 20.73Q54.88 18.85 54.21 18.26Q53.54 17.68 51.76 17.68ZM86.16 10.91L92.04 50.44L81.52 50.44L81.01 43.33L77.32 43.33L76.71 50.44L66.06 50.44L71.29 10.91L86.16 10.91M80.71 36.33Q79.93 29.61 79.15 19.75Q77.59 31.08 77.20 36.33L80.71 36.33ZM115.58 22.88L106.03 22.88L106.03 19.95Q106.03 17.90 105.66 17.33Q105.30 16.77 104.44 16.77Q103.52 16.77 103.04 17.53Q102.56 18.29 102.56 19.82Q102.56 21.80 103.10 22.80Q103.61 23.80 106.01 25.22Q112.87 29.30 114.65 31.91Q116.43 34.52 116.43 40.33Q116.43 44.56 115.44 46.56Q114.45 48.56 111.62 49.91Q108.79 51.27 105.03 51.27Q100.90 51.27 97.99 49.71Q95.07 48.14 94.17 45.73Q93.26 43.31 93.26 38.87L93.26 36.28L102.81 36.28L102.81 41.09Q102.81 43.31 103.21 43.95Q103.61 44.58 104.64 44.58Q105.66 44.58 106.16 43.77Q106.67 42.97 106.67 41.38Q106.67 37.89 105.71 36.82Q104.74 35.74 100.90 33.23Q97.07 30.69 95.83 29.54Q94.58 28.39 93.76 26.37Q92.94 24.34 92.94 21.19Q92.94 16.65 94.10 14.55Q95.26 12.45 97.85 11.27Q100.44 10.08 104.10 10.08Q108.11 10.08 110.93 11.38Q113.75 12.67 114.66 14.64Q115.58 16.60 115.58 21.31L115.58 22.88Z"/></g></g></svg>
                    </div>
                    <div class="logo-subtitle">Ventilationsberegner</div>
                </div>
                <div class="header-controls">
                    <button type="button" id="helpBtn" class="help-button" title="Formelgrundlag">?</button>
                    <div class="theme-switch-wrapper">
                        <span class="theme-switch-label">Future Vibe</span>
                        <label class="theme-switch" for="themeToggle"> <input type="checkbox" id="themeToggle" checked /> <span class="slider"></span> </label>
                    </div>
                </div>
            </div>
            
             <div class="global-settings">
                <div class="input-group">
                    <div class="input-unit-wrapper" data-unit="°C">
                        <label for="temperature">Lufttemperatur</label>
                        <input type="text" id="temperature" class="input-field" value="20">
                    </div>
                </div>
            </div>

            <nav class="tab-nav">
                <button class="tab-link active" data-tab="dimensioning">Kanaldimensionering</button>
                <button class="tab-link" data-tab="fittings">Formstykker</button>
                <button class="tab-link" data-tab="system">Systemberegning</button>
            </nav>

            <div id="dimensioning" class="tab-content"></div>
            <div id="fittings" class="tab-content hidden"></div>
            <div id="system" class="tab-content hidden"></div>
        </div>
        <footer class="app-footer">
            <p>AppVersion 0.13.1_dev --- Spørgsmål kontakt CWA</p>
        </footer>
    </div>
    
    <div id="detailsModal" class="modal">
        <div class="modal-content">
             <div class="modal-header">
                <h3 id="modalTitle">Beregningsdetaljer</h3>
                <span id="modalCloseDetails" class="close-button">&times;</span>
            </div>
            <div id="modalBody" class="modal-body"></div>
        </div>
    </div>
    <div id="helpModal" class="modal"> </div>

    <script>
        // --- CONSTANTS & DATA ---
        const K_ROUGHNESS = 0.00015;
        const WALL_THICKNESS_MM = 0.5;
        
        const CIRCULAR_BEND_ZETA = { "rd1_0": { "45": { "75": 0.20, "100": 0.17, "125": 0.14, "150": 0.11, "200": 0.11, "250": 0.11 }, "90": { "75": 0.44, "100": 0.37, "125": 0.30, "150": 0.25, "200": 0.24, "250": 0.24 } }, "rd1_5": { "45": { "75": 0.18, "100": 0.13, "125": 0.10, "150": 0.08, "200": 0.07, "250": 0.07 }, "90": { "75": 0.30, "100": 0.21, "125": 0.16, "150": 0.14, "200": 0.11, "250": 0.11 } } };
        const RECTANGULAR_BEND_ZETA = { mainTable: { "0.25": { "0.5": 1.53, "0.75": 0.57, "1": 0.27, "1.5": 0.22, "2": 0.20 }, "0.50": { "0.5": 1.38, "0.75": 0.52, "1": 0.25, "1.5": 0.20, "2": 0.18 }, "0.75": { "0.5": 1.29, "0.75": 0.48, "1": 0.23, "1.5": 0.19, "2": 0.16 }, "1.00": { "0.5": 1.18, "0.75": 0.44, "1": 0.21, "1.5": 0.17, "2": 0.15 }, "2.00": { "0.5": 1.06, "0.75": 0.40, "1": 0.19, "1.5": 0.15, "2": 0.14 }, "3.00": { "0.5": 1.00, "0.75": 0.39, "1": 0.18, "1.5": 0.14, "2": 0.13 }, "4.00": { "0.5": 1.00, "0.75": 0.39, "1": 0.18, "1.5": 0.14, "2": 0.13 }, "5.00": { "0.5": 1.06, "0.75": 0.40, "1": 0.19, "1.5": 0.15, "2": 0.14 }, "6.00": { "0.5": 1.12, "0.75": 0.42, "1": 0.20, "1.5": 0.16, "2": 0.14 }, "7.00": { "0.5": 1.16, "0.75": 0.43, "1": 0.21, "1.5": 0.17, "2": 0.15 }, "8.00": { "0.5": 1.18, "0.75": 0.44, "1": 0.21, "1.5": 0.17, "2": 0.15 } }, kFactor: { "30": 0.45, "45": 0.60, "60": 0.78, "90": 1.00, "180": 1.40 } };
        const EXPANSION_ZETA = { "10": { "2": 0.11, "4": 0.16, "10": 0.21, "16": 0.21 }, "20": { "2": 0.13, "4": 0.22, "10": 0.28, "16": 0.29 }, "30": { "2": 0.19, "4": 0.30, "10": 0.38, "16": 0.38 }, "40": { "2": 0.32, "4": 0.46, "10": 0.59, "16": 0.60 }, "45": { "2": 0.33, "4": 0.61, "10": 0.76, "16": 0.84 }, "60": { "2": 0.33, "4": 0.68, "10": 0.80, "16": 0.88 }, "90": { "2": 0.32, "4": 0.64, "10": 0.83, "16": 0.88 }, "120":{ "2": 0.31, "4": 0.63, "10": 0.84, "16": 0.88 }, "150":{ "2": 0.30, "4": 0.62, "10": 0.83, "16": 0.88 }, "180":{ "2": 0.30, "4": 0.62, "10": 0.83, "16": 0.88 } };
        const CONTRACTION_ZETA = { "10": { "0.1": 0.05, "0.17": 0.05, "0.25": 0.05, "0.5": 0.05 }, "15": { "0.1": 0.05, "0.17": 0.04, "0.25": 0.04, "0.5": 0.05 }, "30": { "0.1": 0.05, "0.17": 0.04, "0.25": 0.04, "0.5": 0.05 }, "45": { "0.1": 0.05, "0.17": 0.04, "0.25": 0.04, "0.5": 0.05 }, "60": { "0.1": 0.07, "0.17": 0.06, "0.25": 0.06, "0.5": 0.06 }, "75": { "0.1": 0.08, "0.17": 0.07, "0.25": 0.07, "0.5": 0.06 }, "90": { "0.1": 0.19, "0.17": 0.18, "0.25": 0.17, "0.5": 0.12 }, "120":{ "0.1": 0.29, "0.17": 0.28, "0.25": 0.27, "0.5": 0.18 }, "150":{ "0.1": 0.37, "0.17": 0.36, "0.25": 0.35, "0.5": 0.24 }, "180":{ "0.1": 0.43, "0.17": 0.42, "0.25": 0.41, "0.5": 0.26 } };

        const STANDARD_ROUND_SIZES_MM = [63, 80, 100, 125, 160, 200, 250, 315, 355, 400, 460, 500, 630, 710, 800, 1000, 1250, 1400, 1500, 1600, 2000];
        const STANDARD_RECT_SIZES_MM = (() => { let arr = []; for (let i = 100; i <= 450; i += 50) arr.push(i); for (let i = 500; i <= 2000; i += 100) arr.push(i); return arr; })();
        let fittingsList = [];
        let ductResult = null;
        let ventilationForm, fittingsForm, fittingTypeSelect, fittingInputsContainer, dimResultsContainer, fittingsResultsContainer, themeToggle, tabs, contents, detailsModal, helpModal;
        let modalTitle, modalBody;
        let systemComponents = []; // To store all components in the system
        let systemAddComponentForm, systemComponentTypeSelect, systemComponentInputsContainer, systemComponentsContainer, totalPressureDropContainer;


        // --- HELPER FUNCTIONS ---
        function parseLocalFloat(str) { return parseFloat(String(str).replace(",", ".")); }
        function formatLocalFloat(num, decimals) { return num.toFixed(decimals).replace(".", ","); }
        function getInternalDim(ext_mm) { return Math.max(0, ext_mm - 2 * WALL_THICKNESS_MM); }
        function getAirProperties(tempCelsius) {
            const T_kelvin = tempCelsius + 273.15;
            const RHO = 101325 / (287.058 * T_kelvin);
            const mu = (1.458e-6 * Math.pow(T_kelvin, 1.5)) / (T_kelvin + 110.4);
            const NU = mu / RHO;
            return { RHO, NU };
        }
        
        // --- TEMPLATES (HTML Injection) ---
        function getDimFormHtml() {
            return `
                <section>
                    <h2>Kanaldimensionering</h2>
                    <form id="ventilationForm">
                        <div class="input-group"> <label for="dim_airflow">Luftmængde</label> <div class="input-unit-wrapper" data-unit="m³/h"><input type="text" id="dim_airflow" class="input-field" required></div> </div>
                        <div class="control-group"> <label>Beregningstype</label> <div class="radio-group"> <input type="radio" id="modeCalculate" name="calculationMode" value="calculate" checked><label for="modeCalculate">Beregn Dimension</label> <input type="radio" id="modeAnalyze" name="calculationMode" value="analyze"><label for="modeAnalyze">Analyser Eksisterende</label> </div> </div>
                        <div class="control-group"> <label>Kanalform</label> <div class="radio-group"> <input type="radio" id="ductRound" name="ductShape" value="round" checked><label for="ductRound">Cirkulær</label> <input type="radio" id="ductRectangular" name="ductShape" value="rectangular"><label for="ductRectangular">Rektangulær</label> </div> </div>
                        <div id="calculateInputs">
                            <div class="input-group"><label for="constraintType">Grænse</label><select id="constraintType" class="input-field"><option value="velocity">Hastighed (m/s)</option><option value="pressure">Tryktab (Pa/m)</option></select></div>
                            <div class="input-group"><label for="constraintValue">Grænseværdi</label><div class="input-unit-wrapper" data-unit="m/s"><input type="text" id="constraintValue" class="input-field" step="any"></div></div>
                            <div id="aspectRatioInput" class="input-group" style="display: none;"><label for="aspectRatio">Sideforhold (A/B)</label><input type="text" id="aspectRatio" class="input-field" value="1,5" step="any"></div>
                        </div>
                        <div id="analyzeInputs" style="display: none;">
                            <div id="analyzeRound" class="input-group"><label for="diameter">Diameter</label><div class="input-unit-wrapper" data-unit="mm"><input type="text" id="diameter" class="input-field" list="diameter-list" placeholder="Vælg eller indtast"></div><datalist id="diameter-list"></datalist></div>
                            <div id="analyzeRectangular" class="input-field-group" style="display: none;">
                                <div class="input-group" style="width: 100%"><label for="sideA">Side A</label><div class="input-unit-wrapper" data-unit="mm"><input type="text" id="sideA" class="input-field" list="rect-list" placeholder="Vælg eller indtast"></div></div>
                                <div class="input-group" style="width: 100%"><label for="sideB">Side B</label><div class="input-unit-wrapper" data-unit="mm"><input type="text" id="sideB" class="input-field" list="rect-list" placeholder="Vælg eller indtast"></div></div>
                                <datalist id="rect-list"></datalist>
                            </div>
                        </div>
                        <button type="submit" class="button primary">Beregn Kanal</button>
                    </form>
                    <div id="dim_resultsContainer" class="results-container"></div>
                </section>`;
        }
        function getFittingsFormHtml() {
            return `
                <section>
                    <h2>Tryktab for Formstykker</h2>
                    <form id="fittingsForm">
                        <div class="input-group">
                            <label for="fittingType">Vælg type formstykke</label>
                            <select id="fittingType" class="input-field">
                                <option value="">-- Vælg type --</option>
                                <optgroup label="Bøjninger">
                                    <option value="bend_circ">Bøjning, Cirkulær</option>
                                    <option value="bend_rect">Bøjning, Rektangulær</option>
                                </optgroup>
                                <optgroup label="Dimensionsændringer">
                                    <option value="expansion">Udvidelse</option>
                                    <option value="contraction">Indsnævring</option>
                                </optgroup>
                                <optgroup label="T-stykker (Cirkulær)">
                                    <option value="tee_sym">T-stykke, Symmetrisk</option>
                                    <option value="tee_asym">T-stykke, Asymmetrisk</option>
                                    <option value="tee_bullhead">T-stykke (Dobbelt Afgrening)</option>
                                </optgroup>
                            </select>
                        </div>
                        <div id="fittingIllustrationContainer"></div>
                        <div id="fittingInputsContainer"></div>
                        <button type="submit" class="button primary">Beregn Formstykke</button>
                    </form>
                    <div id="fittings_resultsContainer" class="results-container"></div>
                </section>`;
        }

        // --- UI INITIALIZATION & LOGIC ---
       function initializeApp() {
            // Inject HTML for all tabs
            document.getElementById('dimensioning').innerHTML = getDimFormHtml();
            document.getElementById('fittings').innerHTML = getFittingsFormHtml();
            document.getElementById('system').innerHTML = getSystemFormHtml(); // Added this line
        
            // Get elements for Dimensioning tab
            ventilationForm = document.getElementById('ventilationForm');
            dimResultsContainer = document.getElementById('dim_resultsContainer');
            
            // Get elements for Fittings tab
            fittingsForm = document.getElementById('fittingsForm');
            fittingTypeSelect = document.getElementById('fittingType');
            fittingInputsContainer = document.getElementById('fittingInputsContainer');
            fittingsResultsContainer = document.getElementById('fittings_resultsContainer');
        
            // Get elements for System tab
            systemAddComponentForm = document.getElementById('systemAddComponentForm');
            systemComponentTypeSelect = document.getElementById('systemComponentType');
            systemComponentInputsContainer = document.getElementById('systemComponentInputsContainer');
            systemComponentsContainer = document.getElementById('systemComponentsContainer');
            totalPressureDropContainer = document.getElementById('totalPressureDropContainer');
            
            // General UI elements
            tabs = document.querySelectorAll('.tab-link');
            contents = document.querySelectorAll('.tab-content');
            themeToggle = document.getElementById('themeToggle');
            detailsModal = document.getElementById('detailsModal');
            helpModal = document.getElementById('helpModal');
            modalTitle = detailsModal.querySelector('#modalTitle');
            modalBody = detailsModal.querySelector('#modalBody');
        
            // Setup event listeners
            populateDatalists();
            updateDimUI();
            updateConstraintDefaults();
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    contents.forEach(c => c.classList.add('hidden'));
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.tab).classList.remove('hidden');
                });
            });
        
            document.getElementsByName('calculationMode').forEach(r => r.addEventListener('change', updateDimUI));
            document.getElementsByName('ductShape').forEach(r => r.addEventListener('change', updateDimUI));
            document.getElementById('constraintType').addEventListener('change', updateConstraintDefaults);
            
            ventilationForm.addEventListener('submit', handleDuctCalculation);
            fittingsForm.addEventListener('submit', handleFittingCalculation);
            fittingTypeSelect.addEventListener('change', renderFittingInputs);
        
            systemComponentTypeSelect.addEventListener('change', handleComponentTypeChange);
            systemAddComponentForm.addEventListener('submit', handleAddComponent);
            
            themeToggle.addEventListener('change', (e) => {
                const theme = e.target.checked ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
            });
        
            document.getElementById('helpBtn').onclick = () => showHelpModal();
            detailsModal.querySelector('.close-button').onclick = () => { detailsModal.style.display = "none"; };
        
            window.onclick = (event) => { 
                if (event.target == detailsModal) { detailsModal.style.display = "none"; }
                if (event.target == helpModal) { helpModal.style.display = "none"; }
            };
        
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            themeToggle.checked = savedTheme === 'dark';
        }
        function updateDimUI() {
            const mode = document.querySelector('input[name="calculationMode"]:checked').value;
            const shape = document.querySelector('input[name="ductShape"]:checked').value;
            document.getElementById('calculateInputs').style.display = mode === 'calculate' ? 'block' : 'none';
            document.getElementById('analyzeInputs').style.display = mode === 'analyze' ? 'block' : 'none';
            document.getElementById('aspectRatioInput').style.display = (mode === 'calculate' && shape === 'rectangular') ? 'block' : 'none';
            document.getElementById('analyzeRound').style.display = (mode === 'analyze' && shape === 'round') ? 'block' : 'none';
            document.getElementById('analyzeRectangular').style.display = (mode === 'analyze' && shape === 'rectangular') ? 'flex' : 'none';
        }
        
        function updateConstraintDefaults() {
            const constraintTypeSelect = document.getElementById('constraintType');
            const constraintValueInput = document.getElementById('constraintValue');
            const unitWrapper = constraintValueInput.parentElement;
            if (constraintTypeSelect.value === 'velocity') {
                constraintValueInput.value = '5';
                unitWrapper.dataset.unit = 'm/s';
            } else { // pressure
                constraintValueInput.value = '0,5';
                unitWrapper.dataset.unit = 'Pa/m';
            }
        }

        function showHelpModal() {
            helpModal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="modalTitleHelp">Formelgrundlag</h3>
                        <span class="close-button">&times;</span>
                    </div>
                    <div id="modalBodyHelp" class="modal-body">
                        <h4>Generelle Principper</h4>
                        <p>Dette værktøj er designet til at assistere med kanalberegninger i henhold til anerkendte principper og normer som <strong>DS 447</strong>. Alle beregninger tager højde for standardiserede fysiske love for at sikre nøjagtighed.</p>
                        <p><strong>Lufttemperatur:</strong> Luftens densitet (ρ) og kinematiske viskositet (ν) justeres dynamisk baseret på den indtastede temperatur. Dette sker via Ideal gasloven og Sutherlands formel for at afspejle virkelige forhold.</p>
                        <p><strong>Godstykkelse:</strong> Der anvendes en standard kanalgodstykkelse på 0,5 mm. Alle indtastede dimensioner er ydre mål, og programmet omregner automatisk til indre mål for alle beregninger.</p>
                        
                        <hr>

                        <h4>Kanaldimensionering (Lige Kanalstræk)</h4>
                        <p>Tryktab i lige kanaler beregnes med <strong>Darcy-Weisbachs ligning</strong>:</p>
                        <p><code>dp = (λ / Dₕ) * (ρ/2) * v²</code></p>
                        <p>Her er de centrale elementer:</p>
                        <ul>
                            <li><strong>Friktionsfaktor (λ):</strong> Denne findes ved en iterativ løsning (50 gentagelser) af <strong>Colebrook-Whites ligning</strong>. Ligningen tager højde for både kanalens ruhed (k) og luftstrømmens turbulens, beskrevet ved Reynolds' tal (Re).</li>
                            <li><strong>Hydraulisk Diameter (Dₕ):</strong> Dette er et nøglebegreb, der tillader at bruge samme formel for forskellige kanalformer.
                                <ul>
                                    <li>For <strong>cirkulære</strong> kanaler er Dₕ lig med den indre diameter.</li>
                                    <li>For <strong>rektangulære</strong> kanaler beregnes Dₕ som: <code>Dₕ = 2*a*b / (a+b)</code>, hvor a og b er de indre sidemål.</li>
                                </ul>
                            </li>
                        </ul>
                        
                        <hr>

                        <h4>Formstykker (Enkeltmodstande)</h4>
                        <p>Tryktab i formstykker (også kaldet enkeltmodstande) beregnes ud fra en tryktabskoefficient (Zeta, ζ), som er unik for hvert formstykkes geometri:</p>
                        <p><code>Δp = ζ * (ρ/2) * v²</code></p>
                        <p><strong>Bøjninger (Cirkulære & Rektangulære), Udvidelser & Indsnævringer:</strong></p>
                        <p>For disse komponenter findes ζ-værdien ikke som en fast konstant. I stedet findes den via <strong>lineær og bilinear interpolation</strong> i indbyggede datatabeller. Værktøjet slår op i tabellerne baseret på de indtastede geometriske forhold (f.eks. vinkel, radiusforhold, sideforhold, arealaforhold) for at finde en præcis, vægtet ζ-værdi, der passer nøjagtigt til det specifikke formstykke.</p>
                        <p>For <strong>rektangulære bøjninger</strong> beregnes hastigheden (v) i formlen baseret på et ækvivalent areal, der er udledt af den <strong>hydrauliske diameter</strong>, for at sikre en konsistent beregningsmetode.</p>

                        <p><strong>T-stykker:</strong></p>
                        <p>Beregningen for T-stykker er mere kompleks, da luftstrømmen både deles og ændrer retning. Her beregnes ζ-værdien dynamisk for hver udgang (ligeud og afgrening) baseret på principperne om <strong>masse- og energibevarelse (Bernoullis ligning)</strong>. Formlerne tager højde for forholdet mellem luftmængder og arealer i de forskellige grene for at bestemme de turbulente tab og dermed en præcis ζ-værdi for hver luftvej.</p>
                    </div>
                </div>`;
            
            const modalCloseHelp = helpModal.querySelector('.close-button');
            modalCloseHelp.onclick = () => { helpModal.style.display = "none"; };
            window.onclick = (event) => { if (event.target == helpModal) { helpModal.style.display = "none"; } };
            helpModal.style.display = 'flex';
        }

        // --- CALCULATION LOGIC & HANDLERS ---
        function populateDatalists() {
            const diameterList = document.getElementById('diameter-list'), rectList = document.getElementById('rect-list');
            if(!diameterList || !rectList) return;
            diameterList.innerHTML = ''; rectList.innerHTML = '';
            STANDARD_ROUND_SIZES_MM.forEach(size => { diameterList.appendChild(new Option('', size)); });
            STANDARD_RECT_SIZES_MM.forEach(size => { rectList.appendChild(new Option('', size)); });
        }
        function renderFittingInputs() {
            const type = fittingTypeSelect.value;
            const illustrationContainer = document.getElementById('fittingIllustrationContainer');
            fittingInputsContainer.innerHTML = ''; 
            illustrationContainer.innerHTML = '';
            if (!type) return;

            let illustrationSvg = '';
            let commonAirflowInput = `<div class="input-group"><label for="fit_airflow">Luftmængde</label><div class="input-unit-wrapper" data-unit="m³/h"><input type="text" id="fit_airflow" class="input-field" required></div></div>`;

            switch (type) {
                case 'bend_circ':
                    illustrationSvg = `<svg width="222" height="106" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="0" y="110" width="222" height="106"/></clipPath><clipPath id="clip1"><rect x="0" y="0" width="2114550" height="1009650"/></clipPath><image width="226" height="105" xlink:href="data:image/jpeg;base64,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" preserveAspectRatio="none" id="img2"></image><clipPath id="clip3"><rect x="0" y="0" width="2114550" height="982424"/></clipPath></defs><g clip-path="url(#clip0)" transform="matrix(1 0 0 1 0 -110)"><g clip-path="url(#clip1)" transform="matrix(0.000104987 0 0 0.000104987 0 110)"><g clip-path="url(#clip3)" transform="matrix(1 0 0 1.02771 0 -0.0625)"><use width="100%" height="100%" xlink:href="#img2" transform="scale(9356.42 9356.42)"></use></g></g></g></svg>`;
                    fittingInputsContainer.innerHTML = `${commonAirflowInput}
                        <div class="input-field-group">
                            <div class="input-unit-wrapper" data-unit="mm"><label for="d">Diameter (d)</label><input type="text" id="d" class="input-field"></div>
                            <div class="input-unit-wrapper" data-unit="°"><label for="angle">Vinkel (α)</label><input type="text" id="angle" class="input-field" value="90"></div>
                            <div class="input-unit-wrapper" data-unit=""><label for="rd">R/d ratio</label><input type="text" id="rd" class="input-field" value="1.0"></div>
                        </div>`;
                    break;
                case 'bend_rect':
                    illustrationSvg = `<svg width="220" height="95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><image width="415" height="174" xlink:href="data:image/jpeg;base64,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" preserveAspectRatio="none" id="img0"></image><clipPath id="clip1"><rect x="0" y="0" width="2095500" height="878595"/></clipPath></defs><g transform="translate(-54 -427)"><g transform="matrix(0.000104987 0 0 0.000104987 54 427)"><g clip-path="url(#clip1)" transform="scale(1 1.02991)"><use width="100%" height="100%" xlink:href="#img0" transform="scale(5049.4 5049.4)"></use></g></g></g></svg>`;
                    fittingInputsContainer.innerHTML = `${commonAirflowInput}
                        <div class="input-field-group">
                            <div class="input-unit-wrapper" data-unit="mm"><label for="h">Højde (H)</label><input type="text" id="h" class="input-field"></div>
                            <div class="input-unit-wrapper" data-unit="mm"><label for="w">Bredde (B)</label><input type="text" id="w" class="input-field"></div>
                            <div class="input-unit-wrapper" data-unit="°"><label for="angle">Vinkel (α)</label><input type="text" id="angle" class="input-field" value="90"></div>
                            <div class="input-unit-wrapper" data-unit=""><label for="rh">R/H ratio</label><input type="text" id="rh" class="input-field" value="1.0"></div>
                        </div>`;
                    break;
                 case 'expansion':
                    illustrationSvg = `<svg width="190" height="70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="128" y="700" width="190" height="70"/></clipPath><clipPath id="clip1"><rect x="0" y="0" width="1809750" height="666750"/></clipPath><image width="285" height="102" xlink:href="data:image/jpeg;base64,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" preserveAspectRatio="none" id="img2"></image><clipPath id="clip3"><rect x="0" y="0" width="1809750" height="647700"/></clipPath></defs><g clip-path="url(#clip0)" transform="translate(-128 -700)"><g clip-path="url(#clip1)" transform="matrix(0.000104987 0 0 0.000104987 128 700)"><g clip-path="url(#clip3)" transform="matrix(1 0 0 1.02941 0 -0.5)"><use width="100%" height="100%" xlink:href="#img2" transform="scale(6350 6350)"></use></g></g></g></svg>`;
                    fittingInputsContainer.innerHTML = `${commonAirflowInput}
                        <div class="input-field-group">
                            <div class="input-unit-wrapper" data-unit="mm"><label for="d1">Diameter Ind (d₁)</label><input type="text" id="d1" class="input-field"></div>
                            <div class="input-unit-wrapper" data-unit="mm"><label for="d2">Diameter Ud (d₂)</label><input type="text" id="d2" class="input-field"></div>
                            <div class="input-unit-wrapper" data-unit="°"><label for="angle">Vinkel (α)</label><input type="text" id="angle" class="input-field" value="30"></div>
                        </div>`;
                    break;
                 case 'contraction':
                    illustrationSvg = `<svg width="185" height="70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="128" y="992" width="185" height="70"/></clipPath><clipPath id="clip1"><rect x="0" y="0" width="1762125" height="666750"/></clipPath><image width="283" height="104" xlink:href="data:image/jpeg;base64,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" preserveAspectRatio="none" id="img2"></image><clipPath id="clip3"><rect x="0" y="0" width="1762125" height="647565"/></clipPath></defs><g clip-path="url(#clip0)" transform="translate(-128 -992)"><g clip-path="url(#clip1)" transform="matrix(0.000104987 0 0 0.000104987 128 992)"><g clip-path="url(#clip3)" transform="scale(1 1.02963)"><use width="100%" height="100%" xlink:href="#img2" transform="scale(6226.59 6226.59)"></use></g></g></g></svg>`;
                     fittingInputsContainer.innerHTML = `${commonAirflowInput}
                        <div class="input-field-group">
                            <div class="input-unit-wrapper" data-unit="mm"><label for="d1">Diameter Ind (d₁)</label><input type="text" id="d1" class="input-field"></div>
                            <div class="input-unit-wrapper" data-unit="mm"><label for="d2">Diameter Ud (d₂)</label><input type="text" id="d2" class="input-field"></div>
                            <div class="input-unit-wrapper" data-unit="°"><label for="angle">Vinkel (α)</label><input type="text" id="angle" class="input-field" value="30"></div>
                        </div>`;
                    break;
                case 'tee_bullhead':
                    illustrationSvg = `<svg width="142" height="79" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="770" y="3526" width="142" height="79"/></clipPath><image width="142" height="79" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI4AAABPAQMAAAAHh29aAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURQAAAADk/7J3YKoAAAABdFJOUwBA5thmAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAnElEQVQ4y2OgE+BvwBBiYqCpEBYbyQTy/4HgAIqQAIhwoKEQ06jQYBViBiWHDwxKCgz1IBYomUGTnxBUDZIQVwOGEDsDhhATphDD4BFiAgmxOCEHCiNUCDmPNUwECTEi63QACyEMAwbXA6AQ+yV2IAtFFYMQipUN8xOAQshmAW1UgDoFyV0OIBIlshoSBmMQkiIETl8IQHYxxsAAAIAmRVut56kWAAAAAElFTkSuQmCC" preserveAspectRatio="none" id="img1"></image><clipPath id="clip2"><rect x="0" y="0" width="1352738" height="752580"/></clipPath></defs><g clip-path="url(#clip0)" transform="translate(-770 -3526)"><g transform="matrix(0.000104972 0 0 0.000104972 770 3526)"><g clip-path="url(#clip2)" transform="matrix(1 0 0 1 -0.0103559 0.412109)"><use width="100%" height="100%" xlink:href="#img1" transform="scale(9526.32 9526.32)"></use></g></g></g></svg>`;
                    fittingInputsContainer.innerHTML = `<div class="sub-group"><label>Luftmængder (q)</label><div class="input-field-group"> <div class="input-unit-wrapper" data-unit="m³/h"><label for="q_in">Ind</label><input type="text" id="q_in" class="input-field" required></div> <div class="input-unit-wrapper" data-unit="m³/h"><label for="q_out1">Ud 1</label><input type="text" id="q_out1" class="input-field" required></div> <div class="input-unit-wrapper" data-unit="m³/h"><label for="q_out2">Ud 2</label><input type="text" id="q_out2" class="input-field" required></div> </div></div><div class="sub-group" id="teeDiameterInputs"><label>Diametre (Ø)</label><div class="input-field-group"> <div class="input-unit-wrapper" data-unit="mm"><label for="d_in">Ind</label><input type="text" id="d_in" class="input-field" required></div> <div class="input-unit-wrapper" data-unit="mm"><label for="d_out1">Ud 1</label><input type="text" id="d_out1" class="input-field" required></div> <div class="input-unit-wrapper" data-unit="mm"><label for="d_out2">Ud 2</label><input type="text" id="d_out2" class="input-field" required></div> </div></div>`;
                    break;
                case 'tee_sym':
                case 'tee_asym':
                    illustrationSvg = `<svg width="142" height="79" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="768" y="3409" width="142" height="79"/></clipPath><image width="142" height="79" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI4AAABPBAMAAADPZ+AqAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAbUExURQAAAADk/wDl/wDk/wDi/gDl/QDl/gDk/QDk/hKeHlcAAAAJdFJOUwD/bEG7pOeM0bJsJmgAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACySURBVFjD7dYxDoJAEAXQP8QD7OglLOUGdrY29kQvYElJ57UxsULWhSG/EPJ/tUsyL5NdFhYbjy9NGjppaQNy5GzL2X8G5k5xYPh2jOREuis6RnICDY0cG3ye4k52vyL9uB9+FYbWpzBNHCf2/pSmcuSs2sncbMY1Nn3/yRTNejQdOXLkyJEjRw7BmfXLV/4u9Znj3BLHeVwoTNUdKc7uaSeG8z4fV4bTomoYzgu4Y2UBeuzaEvAB9MgqAAAAAElFTkSuQmCC" preserveAspectRatio="none" id="img1"></image><clipPath id="clip2"><rect x="0" y="0" width="1352739" height="752580"/></clipPath></defs><g clip-path="url(#clip0)" transform="translate(-768 -3409)"><g transform="matrix(0.000104972 0 0 0.000104972 768 3409)"><g clip-path="url(#clip2)" transform="matrix(1 0 0 1 -0.25 -0.0927734)"><use width="100%" height="100%" xlink:href="#img1" transform="scale(9526.33 9526.33)"></use></g></g></g></svg>`;
                    fittingInputsContainer.innerHTML = `<div class="sub-group"><label>Luftmængder (q)</label><div class="input-field-group"> <div class="input-unit-wrapper" data-unit="m³/h"><label for="q_in">Ind</label><input type="text" id="q_in" class="input-field" required></div> <div class="input-unit-wrapper" data-unit="m³/h"><label for="q_straight">Ligeud</label><input type="text" id="q_straight" class="input-field" required></div> <div class="input-unit-wrapper" data-unit="m³/h"><label for="q_branch">Afgrening</label><input type="text" id="q_branch" class="input-field" required></div> </div></div><div class="sub-group" id="teeDiameterInputs"></div>`;
                    const diaContainer = document.getElementById('teeDiameterInputs');
                    if (type === 'tee_sym') {
                        diaContainer.innerHTML = `<label>Diameter (alle grene)</label><div class="input-unit-wrapper" data-unit="mm"><input type="text" id="d_in" class="input-field" required></div>`;
                    } else {
                        diaContainer.innerHTML = `<label>Diametre (Ø)</label><div class="input-field-group"> <div class="input-unit-wrapper" data-unit="mm"><label for="d_in">Ind</label><input type="text" id="d_in" class="input-field" required></div> <div class="input-unit-wrapper" data-unit="mm"><label for="d_straight">Ligeud</label><input type="text" id="d_straight" class="input-field" required></div> <div class="input-unit-wrapper" data-unit="mm"><label for="d_branch">Afgrening</label><input type="text" id="d_branch" class="input-field" required></div> </div>`;
                    }
                    break;
            }
            if (illustrationSvg) {
                illustrationContainer.innerHTML = `<div class="illustration-container">${illustrationSvg}</div>`;
            }
        }
        function handleDuctCalculation(event) {
            event.preventDefault();
            dimResultsContainer.innerHTML = '';
            try {
                const temp = parseLocalFloat(document.getElementById('temperature').value);
                if (isNaN(temp)) throw new Error("Ugyldig temperatur.");
                const { RHO, NU } = getAirProperties(temp);
                const airflow_m3h = parseLocalFloat(document.getElementById('dim_airflow').value);
                if (isNaN(airflow_m3h) || airflow_m3h <= 0) throw new Error("Ugyldig luftmængde.");
                const Q = airflow_m3h / 3600;
                const mode = document.querySelector('input[name="calculationMode"]:checked').value;
                const shape = document.querySelector('input[name="ductShape"]:checked').value;
                ductResult = mode === 'calculate' ? calculateDimensions(Q, shape, airflow_m3h, RHO, NU) : analyzeDuct(Q, shape, airflow_m3h, RHO, NU);
                renderDuctResult(ductResult);
            } catch (error) { renderError(error.message, dimResultsContainer); }
        }
        function handleFittingCalculation(event) {
            event.preventDefault();
            fittingsResultsContainer.innerHTML = '';
            try {
                const temp = parseLocalFloat(document.getElementById('temperature').value);
                if (isNaN(temp)) throw new Error("Ugyldig temperatur.");
                const { RHO, NU } = getAirProperties(temp);
                const type = fittingTypeSelect.value;
                let fittingResult = {};

                if (type.startsWith('tee')) {
                    if (type === 'tee_bullhead') {
                        const q_in = parseLocalFloat(document.getElementById('q_in').value), q_out1 = parseLocalFloat(document.getElementById('q_out1').value), q_out2 = parseLocalFloat(document.getElementById('q_out2').value);
                        if (Math.abs(q_in - (q_out1 + q_out2)) > 1) throw new Error("Luftmængderne stemmer ikke overens (Ind ≈ Ud 1 + Ud 2).");
                        const d_in = parseLocalFloat(document.getElementById('d_in').value), d_out1 = parseLocalFloat(document.getElementById('d_out1').value), d_out2 = parseLocalFloat(document.getElementById('d_out2').value);
                        if (isNaN(d_in) || isNaN(d_out1) || isNaN(d_out2)) throw new Error("Ugyldige diametre.");
                        const results = calculateBullheadTeeLoss({q_in, q_out1, q_out2}, {d_in, d_out1, d_out2}, RHO);
                        fittingsList.push({ id: Date.now(), name: `Dobbelt Afgr. (Ud 1)`, airflow: q_out1, pressureLoss: results.loss1, details: results.details1, type: 'tee' });
                        fittingsList.push({ id: Date.now() + 1, name: `Dobbelt Afgr. (Ud 2)`, airflow: q_out2, pressureLoss: results.loss2, details: results.details2, type: 'tee' });
                    } else { // tee_sym or tee_asym
                        const q_in = parseLocalFloat(document.getElementById('q_in').value), q_straight = parseLocalFloat(document.getElementById('q_straight').value), q_branch = parseLocalFloat(document.getElementById('q_branch').value);
                        if (Math.abs(q_in - (q_straight + q_branch)) > 1) throw new Error("Luftmængderne stemmer ikke overens (Ind ≈ Ligeud + Afgrening).");
                        const d_in = parseLocalFloat(document.getElementById('d_in').value), d_straight = type === 'tee_sym' ? d_in : parseLocalFloat(document.getElementById('d_straight').value), d_branch = type === 'tee_sym' ? d_in : parseLocalFloat(document.getElementById('d_branch').value);
                        if (isNaN(d_in) || isNaN(d_straight) || isNaN(d_branch) || d_in <= 0 || d_straight <= 0 || d_branch <= 0) throw new Error("Ugyldige diametre for T-stykke.");
                        const results = calculateTeePressureLoss({q_in, q_straight, q_branch}, {d_in, d_straight, d_branch}, RHO);
                        const name_base = type === 'tee_sym' ? `T-stykke Sym. Ø${d_in}` : `T-stykke Asym.`;
                        fittingsList.push({ id: Date.now(), name: `${name_base} (Ligeud)`, airflow: q_straight, pressureLoss: results.loss_straight, details: results.details_straight, type: 'tee' });
                        fittingsList.push({ id: Date.now() + 1, name: `${name_base} (Afgrening)`, airflow: q_branch, pressureLoss: results.loss_branch, details: results.details_branch, type: 'tee' });
                    }
                } else { // All other fittings
                    const q_m3h = parseLocalFloat(document.getElementById('fit_airflow').value);
                    if (isNaN(q_m3h) || q_m3h <= 0) throw new Error("Ugyldig luftmængde.");
                    const Q = q_m3h / 3600;
                    let name, zeta, A, v, d_hyd, Pdyn_Pa, loss, details = {};

                    switch(type) {
                        case 'bend_circ':
                            const d = parseLocalFloat(document.getElementById('d').value), angle = parseLocalFloat(document.getElementById('angle').value), rd = parseLocalFloat(document.getElementById('rd').value);
                            const rd_key = rd < 1.25 ? "rd1_0" : "rd1_5";
                            const zeta_table = CIRCULAR_BEND_ZETA[rd_key];
                            zeta = interpolateValue(angle, d, zeta_table);
                            d_hyd = getInternalDim(d)/1000;
                            A = Math.PI * (d_hyd/2)**2;
                            v = Q/A;
                            name = `Bøjning Cirk. Ø${d}`;
                            break;
                        case 'bend_rect':
                            const h = parseLocalFloat(document.getElementById('h').value), w = parseLocalFloat(document.getElementById('w').value), angle_r = parseLocalFloat(document.getElementById('angle').value), rh = parseLocalFloat(document.getElementById('rh').value);
                            const hw_ratio = h/w;
                            const zeta_base = interpolateValue(hw_ratio, rh, RECTANGULAR_BEND_ZETA.mainTable);
                            const k_factor = interpolateValue(angle_r, null, RECTANGULAR_BEND_ZETA.kFactor);
                            zeta = zeta_base * k_factor;
                            let h_int = getInternalDim(h)/1000, w_int = getInternalDim(w)/1000;
                            d_hyd = (2 * h_int * w_int) / (h_int + w_int);
                            A = Math.PI * (d_hyd/2)**2; // Ækvivalent areal
                            v = Q/A;
                            name = `Bøjning Rekt. ${h}x${w}`;
                            break;
                        case 'expansion':
                            const d1_exp = parseLocalFloat(document.getElementById('d1').value), d2_exp = parseLocalFloat(document.getElementById('d2').value), angle_exp = parseLocalFloat(document.getElementById('angle').value);
                            const A1 = Math.PI * (getInternalDim(d1_exp)/2000)**2, A2 = Math.PI * (getInternalDim(d2_exp)/2000)**2;
                            const area_ratio_exp = A2/A1;
                            zeta = interpolateValue(angle_exp, area_ratio_exp, EXPANSION_ZETA);
                            v = Q/A1; // Use inlet velocity for expansion
                            A = A1;
                            name = `Udvidelse Ø${d1_exp}-Ø${d2_exp}`;
                            break;
                         case 'contraction':
                            const d1_con = parseLocalFloat(document.getElementById('d1').value), d2_con = parseLocalFloat(document.getElementById('d2').value), angle_con = parseLocalFloat(document.getElementById('angle').value);
                            const A1_con = Math.PI * (getInternalDim(d1_con)/2000)**2, A2_con = Math.PI * (getInternalDim(d2_con)/2000)**2;
                            const area_ratio_con = A2_con/A1_con;
                            zeta = interpolateValue(angle_con, area_ratio_con, CONTRACTION_ZETA);
                            v = Q/A2_con; // Use outlet velocity for contraction
                            A = A2_con;
                            name = `Indsnævring Ø${d1_con}-Ø${d2_con}`;
                            break;
                    }
                    
                    Pdyn_Pa = (RHO / 2) * v ** 2;
                    loss = zeta * Pdyn_Pa;
                    details = { Q_m3s: Q, A_m2: A, v_ms: v, zeta: zeta, Pdyn_Pa: Pdyn_Pa };
                    fittingsList.push({ id: Date.now(), name, airflow: q_m3h, pressureLoss: loss, details, type });
                }
                renderFittingsResult();
            } catch (error) { renderError(error.message, fittingsResultsContainer); }
        }
        function calculateFrictionFactor(hydraulicDiameter, velocity, NU) {
            const Re = (velocity * hydraulicDiameter) / NU;
            if (Re < 2300) return 64 / Re;
            let lambda = 0.02; const term1 = K_ROUGHNESS / (3.7 * hydraulicDiameter);
            for(let i = 0; i < 50; i++) { let f_inv = -2 * Math.log10(term1 + (2.51 / (Re * Math.sqrt(lambda)))); lambda = 1 / (f_inv * f_inv); }
            return lambda;
        }
        function getPerformance(Q, D_hyd_ext, area_ext, RHO, NU) {
            const d_int_mm = getInternalDim(area_ext.a || D_hyd_ext * 1000);
            const a_int_mm = getInternalDim(area_ext.a);
            const b_int_mm = getInternalDim(area_ext.b);
            const D_hyd_int = area_ext.shape === 'round' ? d_int_mm / 1000 : (2 * (a_int_mm/1000) * (b_int_mm/1000)) / ((a_int_mm/1000) + (b_int_mm/1000));
            const area_int = area_ext.shape === 'round' ? Math.PI * (D_hyd_int / 2)**2 : (a_int_mm/1000) * (b_int_mm/1000);
            if(area_int <= 0) throw new Error("Kanalens indre dimension er nul eller negativ pga. godstykkelse.");
            const velocity = Q / area_int;
            const lambda = calculateFrictionFactor(D_hyd_int, velocity, NU);
            const pressureDrop = (lambda / D_hyd_int) * (RHO / 2) * velocity**2;
            const reynolds = (velocity * D_hyd_int) / NU;
            return { velocity, pressureDrop, lambda, reynolds, D_hyd_int };
        }
        
        function calculateDimensions(Q, shape, airflow_m3h, RHO, NU) {
            const constraint = document.getElementById('constraintType').value, value = parseLocalFloat(document.getElementById('constraintValue').value);
            if (isNaN(value) || value <= 0) throw new Error("Ugyldig grænseværdi.");
            let result = { mode: 'calculate', shape, airflow: airflow_m3h, alternatives: {} };
            if (shape === 'round') {
                let ideal_d_ext_m;
                if(constraint === 'velocity') { const A_int = Q / value; const d_int_m = Math.sqrt(4 * A_int / Math.PI); ideal_d_ext_m = d_int_m + (2 * WALL_THICKNESS_MM / 1000); } 
                else { let D_ext = 0.1; for(let i=0; i<10; i++) { const D_int = getInternalDim(D_ext * 1000) / 1000; if(D_int <= 0) { D_ext *= 1.1; continue; } const A_int = Math.PI * (D_int/2)**2, v = Q / A_int; const lambda = calculateFrictionFactor(D_int, v, NU); const dp = (lambda/D_int) * (RHO/2) * v**2; D_ext *= Math.pow(dp / value, 0.2); } ideal_d_ext_m = D_ext; }
                const chosenIndex = STANDARD_ROUND_SIZES_MM.findIndex(s => s >= ideal_d_ext_m * 1000);
                const std_d_mm = STANDARD_ROUND_SIZES_MM[chosenIndex] || STANDARD_ROUND_SIZES_MM[STANDARD_ROUND_SIZES_MM.length-1];
                const perf_chosen = getPerformance(Q, std_d_mm / 1000, {shape: 'round'}, RHO, NU);
                result = { ...result, idealDiameter: ideal_d_ext_m * 1000, standardDiameter: std_d_mm, ...perf_chosen };
                if (chosenIndex > 0) { const smaller_d_mm = STANDARD_ROUND_SIZES_MM[chosenIndex - 1]; result.alternatives.smaller = { dimension: smaller_d_mm, ...getPerformance(Q, smaller_d_mm / 1000, {shape: 'round'}, RHO, NU) }; }
                if (chosenIndex > -1 && chosenIndex < STANDARD_ROUND_SIZES_MM.length - 1) { const larger_d_mm = STANDARD_ROUND_SIZES_MM[chosenIndex + 1]; result.alternatives.larger = { dimension: larger_d_mm, ...getPerformance(Q, larger_d_mm / 1000, {shape: 'round'}, RHO, NU) }; }
            } else {
                 const ratio = parseLocalFloat(document.getElementById('aspectRatio').value);
                if (isNaN(ratio) || ratio <= 0) throw new Error("Ugyldigt sideforhold.");
                let ideal_a_ext_m, ideal_b_ext_m;
                if(constraint === 'velocity') { const A_int = Q / value; const b_int_m = Math.sqrt(A_int / ratio); const a_int_m = b_int_m * ratio; ideal_a_ext_m = a_int_m + 2 * WALL_THICKNESS_MM / 1000; ideal_b_ext_m = b_int_m + 2 * WALL_THICKNESS_MM / 1000; } 
                else { let A_ext = Q / 5; for(let i=0; i<10; i++) { let a_ext_m = Math.sqrt(A_ext * ratio), b_ext_m = a_ext_m / ratio; const a_int_m = getInternalDim(a_ext_m * 1000) / 1000, b_int_m = getInternalDim(b_ext_m * 1000) / 1000; if(a_int_m <= 0 || b_int_m <= 0) { A_ext *= 1.1; continue; } const D_hyd_int = (2 * a_int_m * b_int_m) / (a_int_m + b_int_m); const A_int = a_int_m * b_int_m; const v = Q / A_int; const lambda = calculateFrictionFactor(D_hyd_int, v, NU); const dp = (lambda/D_hyd_int) * (RHO/2) * v**2; A_ext *= Math.pow(dp / value, 0.4); } ideal_b_ext_m = Math.sqrt(A_ext / ratio); ideal_a_ext_m = ideal_b_ext_m * ratio; }
                const std_a_mm = STANDARD_RECT_SIZES_MM.find(s => s >= ideal_a_ext_m * 1000) || 2000;
                const std_b_mm = STANDARD_RECT_SIZES_MM.find(s => s >= ideal_b_ext_m * 1000) || 2000;
                const perf = getPerformance(Q, 0, {shape: 'rect', a: std_a_mm, b: std_b_mm }, RHO, NU);
                result = { ...result, idealSideA: ideal_a_ext_m*1000, idealSideB: ideal_b_ext_m*1000, standardSideA: std_a_mm, standardSideB: std_b_mm, ...perf };
            }
            return result;
        }
        function analyzeDuct(Q, shape, airflow_m3h, RHO, NU) {
            let params;
            if (shape === 'round') { const d = parseLocalFloat(document.getElementById('diameter').value); if (isNaN(d) || d <= 0) throw new Error("Ugyldig diameter."); params = { mode: 'analyze', shape, airflow: airflow_m3h, diameter: d, sideA: 0, sideB: 0 }; return { ...params, ...getPerformance(Q, d/1000, {shape:'round'}, RHO, NU) }; }
            else { const a = parseLocalFloat(document.getElementById('sideA').value), b = parseLocalFloat(document.getElementById('sideB').value); if (isNaN(a) || isNaN(b) || a <= 0 || b <= 0) throw new Error("Ugyldige dimensioner."); const a_m = a/1000, b_m = b/1000; const D_hyd = (2 * a_m * b_m) / (a_m + b_m); params = { mode: 'analyze', shape, airflow: airflow_m3h, diameter:0, sideA:a, sideB:b, D_hyd, area: {shape:'rect', a:a, b:b} }; return { ...params, ...getPerformance(Q, D_hyd, {shape:'rect', a:a, b:b}, RHO, NU) }; }
        }
        function calculateTeePressureLoss(flows, diams, RHO) {
            const Q_c = flows.q_in / 3600, Q_s = flows.q_straight / 3600, Q_b = flows.q_branch / 3600;
            const d_c_int = getInternalDim(diams.d_in), d_s_int = getInternalDim(diams.d_straight), d_b_int = getInternalDim(diams.d_branch);
            const A_c = Math.PI * (d_c_int / 2000)**2, A_s = Math.PI * (d_s_int / 2000)**2, A_b = Math.PI * (d_b_int / 2000)**2;
            const v_c = Q_c / A_c, v_s = Q_s / A_s, v_b = Q_b / A_b;
            const C_s = 1.0 - (Q_s/Q_c)**2 * (1 - (A_s/A_c)**2);
            const C_b = (1.0 + (v_b/v_c)**2) - 2 * (v_s/v_c)**2 * (A_s/A_c) * (Q_s/Q_c);
            const dynamicPressureIn = (RHO / 2) * v_c**2;
            const details_straight = { Q_m3s: Q_s, A_m2: A_s, v_ms: v_s, zeta: C_s, Pdyn_Pa: dynamicPressureIn };
            const details_branch = { Q_m3s: Q_b, A_m2: A_b, v_ms: v_b, zeta: C_b, Pdyn_Pa: dynamicPressureIn };
            return { loss_straight: C_s * dynamicPressureIn, loss_branch: C_b * dynamicPressureIn, details_straight, details_branch };
        }
        function calculateBullheadTeeLoss(flows, diams, RHO) {
            const Q_c = flows.q_in / 3600, Q_1 = flows.q_out1 / 3600, Q_2 = flows.q_out2 / 3600;
            const d_c_int = getInternalDim(diams.d_in), d_1_int = getInternalDim(diams.d_out1), d_2_int = getInternalDim(diams.d_out2);
            const A_c = Math.PI * (d_c_int / 2000)**2, A_1 = Math.PI * (d_1_int / 2000)**2, A_2 = Math.PI * (d_2_int / 2000)**2;
            const v_c = Q_c / A_c, v_1 = Q_1 / A_1, v_2 = Q_2 / A_2;
            const C_1 = 1.0 + (v_1/v_c)**2;
            const C_2 = 1.0 + (v_2/v_c)**2;
            const dynamicPressureIn = (RHO / 2) * v_c**2;
            const details1 = { Q_m3s: Q_1, A_m2: A_1, v_ms: v_1, zeta: C_1, Pdyn_Pa: dynamicPressureIn };
            const details2 = { Q_m3s: Q_2, A_m2: A_2, v_ms: v_2, zeta: C_2, Pdyn_Pa: dynamicPressureIn };
            return { loss1: C_1 * dynamicPressureIn, loss2: C_2 * dynamicPressureIn, details1, details2 };
        }
        function renderError(message, container) { container.innerHTML = `<div class="result-card error"><h3>Fejl</h3><p>${message}</p></div>`; }
        function renderDuctResult(data) {
            ductResult = data;
            let content = `<p><strong>Beregnet med Luftmængde (q):</strong> ${formatLocalFloat(data.airflow, 0)} m³/h</p>`;
            if (data.mode === 'calculate') {
                content += data.shape === 'round' ? `<p>Beregnet ideal-diameter: ${formatLocalFloat(data.idealDiameter, 1)} mm</p>` : `<p>Beregnet ideal-dimension: ${formatLocalFloat(data.idealSideA, 1)} x ${formatLocalFloat(data.idealSideB, 1)} mm</p>`;
                let comparisonRows = '';
                if(data.alternatives.smaller) { comparisonRows += `<tr><td>Ø${data.alternatives.smaller.dimension}</td><td>${formatLocalFloat(data.alternatives.smaller.velocity,2)}</td><td>${formatLocalFloat(data.alternatives.smaller.pressureDrop,2)}</td></tr>`; }
                comparisonRows += `<tr class="chosen-row"><td><strong>Ø${data.standardDiameter}</strong></td><td><strong>${formatLocalFloat(data.velocity,2)}</strong></td><td><strong>${formatLocalFloat(data.pressureDrop,2)}</strong></td></tr>`;
                if(data.alternatives.larger) { comparisonRows += `<tr><td>Ø${data.alternatives.larger.dimension}</td><td>${formatLocalFloat(data.alternatives.larger.velocity,2)}</td><td>${formatLocalFloat(data.alternatives.larger.pressureDrop,2)}</td></tr>`; }
                content += `<table class="comparison-table"><thead><tr><th>Dimension</th><th>Hastighed (m/s)</th><th>Tryktab (Pa/m)</th></tr></thead><tbody>${comparisonRows}</tbody></table>`;
            } else {
                content += data.shape === 'round' ? `<p class="highlight"><strong>Analyseret Kanal:</strong> ${data.diameter} mm</p>` : `<p class="highlight"><strong>Analyseret Kanal:</strong> ${data.sideA} x ${data.sideB} mm</p>`;
                content += `<p><strong>Lufthastighed (v):</strong> ${formatLocalFloat(data.velocity, 2)} m/s</p><p><strong>Tryktab pr. meter (dp):</strong> ${formatLocalFloat(data.pressureDrop, 2)} Pa/m</p>`;
            }
            dimResultsContainer.innerHTML = `<div class="result-card"><h3>Resultat for Kanal <button class="details-btn" onclick='showDuctDetails()'>ⓘ</button></h3>${content}</div>`;
        }
        function renderFittingsResult() {
            fittingsResultsContainer.innerHTML = '';
            if (fittingsList.length > 0) {
                const totalLoss = fittingsList.reduce((acc, item) => acc + item.pressureLoss, 0);
                
                let tableRows = fittingsList.map(item => {
                    return `<tr><td>${item.name}<br><small>(${formatLocalFloat(item.airflow, 0)} m³/h)</small></td><td>${formatLocalFloat(item.pressureLoss, 2)} Pa</td><td><button class="details-btn" onclick='showFittingDetails(${item.id})'>ⓘ</button><button class="delete-btn" onclick="deleteFitting(${item.id})">&times;</button></td></tr>`
                }).join('');

                const summaryContent = `<div class="result-card"><h3>Samlet Tryktab</h3><table class="fittings-table"><thead><tr><th>Komponent</th><th>Tryktab</th><th></th></tr></thead><tbody>${tableRows}</tbody><tfoot><tr><td>Total</td><td>${formatLocalFloat(totalLoss, 2)} Pa</td><td></td></tr></tfoot></table><button onclick="resetFittings()" class="button secondary">Nulstil Liste</button></div>`;
                
                fittingsResultsContainer.innerHTML = summaryContent;
            }
        }
        function showDuctDetails() {
            if(!ductResult) return;
            const temp = parseLocalFloat(document.getElementById('temperature').value);
            const { RHO, NU } = getAirProperties(temp);
            const D_hyd_int = ductResult.D_hyd_int;
            modalTitle.innerText = "Detaljer for Kanaldimensionering";
            modalBody.innerHTML = `<p><strong>Luftmængde (q):</strong> ${formatLocalFloat(ductResult.airflow, 0)} m³/h</p><p><strong>Hydraulisk Diameter (Dₕ, intern):</strong> ${formatLocalFloat(D_hyd_int, 4)} m</p><p><strong>Hastighed (v):</strong> ${formatLocalFloat(ductResult.velocity, 2)} m/s</p><p><strong>Reynolds Tal (Re):</strong> ${ductResult.reynolds.toExponential(2).replace('.',',')}</p><p><strong>Friktionsfaktor (λ):</strong> ${formatLocalFloat(ductResult.lambda, 4)}</p><hr><p><strong>Tryktab (dp) =</strong> (λ / Dₕ) * (ρ/2) * v²</p><p><strong>dp =</strong> (${formatLocalFloat(ductResult.lambda,4)} / ${formatLocalFloat(D_hyd_int,4)}) * (${formatLocalFloat(RHO,2)}/2) * ${formatLocalFloat(ductResult.velocity,2)}² = <strong>${formatLocalFloat(ductResult.pressureDrop, 2)} Pa/m</strong></p>`;
            detailsModal.style.display = 'flex';
        }
        function showFittingDetails(id) {
            const item = fittingsList.find(f => f.id === id);
            if(!item) return;
            const { details, pressureLoss, name, airflow } = item;
            modalTitle.innerText = `Detaljer for ${name}`;
            modalBody.innerHTML = `<p><strong>Luftmængde (q):</strong> ${formatLocalFloat(airflow, 0)} m³/h</p><p><strong>Areal (A, intern):</strong> ${formatLocalFloat(details.A_m2, 5)} m²</p><p><strong>Hastighed (v):</strong> ${formatLocalFloat(details.v_ms, 2)} m/s</p><p><strong>Zeta-værdi (ζ):</strong> ${formatLocalFloat(details.zeta, 3)}</p><p><strong>Dynamisk Tryk (Pₐᵧₙ):</strong> ${formatLocalFloat(details.Pdyn_Pa, 2)} Pa</p><hr><p><strong>Tryktab (Δp) =</strong> ζ * Pₐᵧₙ</p><p><strong>Δp =</strong> ${formatLocalFloat(details.zeta, 3)} * ${formatLocalFloat(details.Pdyn_Pa, 2)} = <strong>${formatLocalFloat(pressureLoss, 2)} Pa</strong></p>`;
            detailsModal.style.display = 'flex';
        }
        function deleteFitting(id) { fittingsList = fittingsList.filter(f => f.id !== id); if(fittingsList.find(f => f.id === id+1 || f.id === id-1)) { fittingsList = fittingsList.filter(f => f.id !== id+1 && f.id !== id-1); } renderFittingsResult(); }
        function resetFittings() { fittingsList = []; fittingTypeSelect.value = ''; renderFittingInputs(); renderFittingsResult(); }

        function getSurroundingKeys(val, keys) {
            const sortedKeys = keys.map(Number).sort((a, b) => a - b);
            
            if (val <= sortedKeys[0]) return [sortedKeys[0], sortedKeys[0]];
            if (val >= sortedKeys[sortedKeys.length - 1]) {
                const lastKey = sortedKeys[sortedKeys.length - 1];
                return [lastKey, lastKey];
            }

            for (let i = 0; i < sortedKeys.length - 1; i++) {
                if (val >= sortedKeys[i] && val <= sortedKeys[i + 1]) {
                    return [sortedKeys[i], sortedKeys[i + 1]];
                }
            }
            return [sortedKeys[0], sortedKeys[sortedKeys.length-1]]; // Fallback
        }

        function interpolateValue(x, y, table) {
            const lerp = (v0, v1, t) => v0 * (1 - t) + v1 * t;
            
            const xAllKeys_str = Object.keys(table);
            const [x1_num, x2_num] = getSurroundingKeys(x, xAllKeys_str);
            
            const x1_key_str = xAllKeys_str.find(k => parseFloat(k) === x1_num);
            const x2_key_str = xAllKeys_str.find(k => parseFloat(k) === x2_num);

            if (y === null) { // 1D interpolation
                const y1 = table[x1_key_str];
                const y2 = table[x2_key_str];
                if (x1_num === x2_num) return y1;
                const t = (x - x1_num) / (x2_num - x1_num);
                return lerp(y1, y2, t);
            }

            // 2D Bilinear interpolation
            const yAllKeys_str = Object.keys(table[x1_key_str]);
            const [y1_num, y2_num] = getSurroundingKeys(y, yAllKeys_str);
            
            const y1_key_str = yAllKeys_str.find(k => parseFloat(k) === y1_num);
            const y2_key_str = yAllKeys_str.find(k => parseFloat(k) === y2_num);

            const q11 = table[x1_key_str][y1_key_str];
            const q12 = table[x1_key_str][y2_key_str];
            const q21 = table[x2_key_str][y1_key_str];
            const q22 = table[x2_key_str][y2_key_str];
            
            if (x1_num === x2_num && y1_num === y2_num) return q11;

            if (x1_num === x2_num) { // Interpolate on Y axis only
                 if (y1_num === y2_num) return q11;
                 const ty = (y - y1_num) / (y2_num - y1_num);
                 return lerp(q11, q12, ty);
            }
             if (y1_num === y2_num) { // Interpolate on X axis only
                 const tx = (x - x1_num) / (x2_num - x1_num);
                 return lerp(q11, q21, tx);
            }

            const tx = (x - x1_num) / (x2_num - x1_num);
            const ty = (y - y1_num) / (y2_num - y1_num);

            const r1 = lerp(q11, q21, tx);
            const r2 = lerp(q12, q22, tx);
            
            return lerp(r1, r2, ty);
        }

function handleComponentTypeChange() {
    const type = systemComponentTypeSelect.value;
    systemComponentInputsContainer.innerHTML = ''; // Clear previous inputs

    if (type === 'straightDuct') {
        // Build dropdowns from the standard size arrays
        const roundOptions = STANDARD_ROUND_SIZES_MM.map(s => `<option value="${s}">${s} mm</option>`).join('');
        const rectOptions = STANDARD_RECT_SIZES_MM.map(s => `<option value="${s}">${s} mm</option>`).join('');

        systemComponentInputsContainer.innerHTML = `
            <div class="input-group">
                <label for="ductLength">Længde</label>
                <div class="input-unit-wrapper" data-unit="m">
                    <input type="text" id="ductLength" class="input-field" required>
                </div>
            </div>
            <div class="input-group">
                 <label>Kanalform</label> 
                 <div class="radio-group"> 
                    <input type="radio" id="sysDuctRound" name="sysDuctShape" value="round" checked><label for="sysDuctRound">Cirkulær</label> 
                    <input type="radio" id="sysDuctRect" name="sysDuctShape" value="rectangular"><label for="sysDuctRect">Rektangulær</label> 
                 </div>
            </div>
            <div id="sysDuctInputsContainer"></div>
            <button type="submit" class="button primary">Tilføj til System</button>
        `;
        
        const renderDuctInputs = () => {
            const shape = document.querySelector('input[name="sysDuctShape"]:checked').value;
            const container = document.getElementById('sysDuctInputsContainer');
            if (shape === 'round') {
                container.innerHTML = `<div class="input-group"><label for="ductDiameter">Diameter</label><select id="ductDiameter" class="input-field">${roundOptions}</select></div>`;
            } else {
                container.innerHTML = `<div class="input-field-group"><div class="input-group"><label for="ductSideA">Side A</label><select id="ductSideA" class="input-field">${rectOptions}</select></div><div class="input-group"><label for="ductSideB">Side B</label><select id="ductSideB" class="input-field">${rectOptions}</select></div></div>`;
            }
        };

        document.getElementsByName('sysDuctShape').forEach(r => r.addEventListener('change', renderDuctInputs));
        renderDuctInputs();

    } else if (type === 'fitting') {
        systemComponentInputsContainer.innerHTML = `
            <div class="input-group">
                <label for="systemFittingType">Vælg type formstykke</label>
                <select id="systemFittingType" class="input-field">
                    <option value="">-- Vælg type --</option>
                    <optgroup label="Bøjninger">
                        <option value="bend_circ">Bøjning, Cirkulær</option>
                        <option value="bend_rect">Bøjning, Rektangulær</option>
                    </optgroup>
                    <optgroup label="Dimensionsændringer">
                        <option value="expansion">Udvidelse</option>
                        <option value="contraction">Indsnævring</option>
                    </optgroup>
                    <optgroup label="T-stykker (Cirkulær)">
                        <option value="tee_sym">T-stykke, Symmetrisk</option>
                        <option value="tee_asym">T-stykke, Asymmetrisk</option>
                    </optgroup>
                </select>
            </div>
            <div id="systemFittingInputsContainer"></div>
        `;
        document.getElementById('systemFittingType').addEventListener('change', renderSystemFittingInputs);
    
    } else if (type === 'manualLoss') {
        systemComponentInputsContainer.innerHTML = `
            <div class="input-field-group">
                 <div class="input-group"><label for="manualLossName">Beskrivelse</label><input type="text" id="manualLossName" class="input-field" placeholder="F.eks. Special-rist" required></div>
                <div class="input-group"><label for="manualLossValue">Tryktab</label><div class="input-unit-wrapper" data-unit="Pa"><input type="text" id="manualLossValue" class="input-field" required></div></div>
            </div>
            <button type="submit" class="button primary">Tilføj til System</button>
        `;
    }
}
        
        // This is a NEW helper function to show the inputs for the selected fitting
function renderSystemFittingInputs() {
    const fittingType = document.getElementById('systemFittingType').value;
    const container = document.getElementById('systemFittingInputsContainer');
    container.innerHTML = ''; // Clear old inputs

    if (!fittingType) return;
    
    // Build dropdowns from the standard size arrays
    const roundOptions = STANDARD_ROUND_SIZES_MM.map(s => `<option value="${s}">${s} mm</option>`).join('');
    const rectOptions = STANDARD_RECT_SIZES_MM.map(s => `<option value="${s}">${s} mm</option>`).join('');

    let inputsHtml = '';
    switch (fittingType) {
        case 'bend_circ':
            inputsHtml = `
                <div class="input-field-group">
                    <div class="input-group"><label for="sys_d">Diameter (d)</label><select id="sys_d" class="input-field">${roundOptions}</select></div>
                    <div class="input-group"><label for="sys_angle">Vinkel (α)</label><input type="text" id="sys_angle" class="input-field" value="90"></div>
                    <div class="input-group"><label for="sys_rd">R/d ratio</label><input type="text" id="sys_rd" class="input-field" value="1.0"></div>
                </div>`;
            break;
        case 'bend_rect':
             inputsHtml = `
                <div class="input-field-group">
                    <div class="input-group"><label for="sys_h">Højde (H)</label><select id="sys_h" class="input-field">${rectOptions}</select></div>
                    <div class="input-group"><label for="sys_w">Bredde (B)</label><select id="sys_w" class="input-field">${rectOptions}</select></div>
                    <div class="input-group"><label for="sys_angle_r">Vinkel (α)</label><input type="text" id="sys_angle_r" class="input-field" value="90"></div>
                    <div class="input-group"><label for="sys_rh">R/H ratio</label><input type="text" id="sys_rh" class="input-field" value="1.0"></div>
                </div>`;
            break;
        case 'expansion':
        case 'contraction':
            inputsHtml = `
                <div class="input-field-group">
                    <div class="input-group"><label for="sys_d1">Diameter Ind (d₁)</label><select id="sys_d1" class="input-field">${roundOptions}</select></div>
                    <div class="input-group"><label for="sys_d2">Diameter Ud (d₂)</label><select id="sys_d2" class="input-field">${roundOptions}</select></div>
                    <div class="input-group"><label for="sys_angle_dim">Vinkel (α)</label><input type="text" id="sys_angle_dim" class="input-field" value="30"></div>
                </div>`;
            break;
case 'tee_sym':
        case 'tee_asym':
            const isSym = fittingType === 'tee_sym';
            const diameterInputs = isSym ?
                `<div class="input-group"><label>Diameter (alle grene)</label><select id="sys_tee_d_in" class="input-field">${roundOptions}</select></div>` :
                `<div class="input-field-group">
                    <div class="input-group"><label for="sys_tee_d_in">Ø Ind</label><select id="sys_tee_d_in" class="input-field">${roundOptions}</select></div>
                    <div class="input-group"><label for="sys_tee_d_straight">Ø Ligeud</label><select id="sys_tee_d_straight" class="input-field">${roundOptions}</select></div>
                    <div class="input-group"><label for="sys_tee_d_branch">Ø Afgrening</label><select id="sys_tee_d_branch" class="input-field">${roundOptions}</select></div>
                </div>`;

            inputsHtml = `
                <div class="sub-group">
                    <label>Luftmængder (Ligeud + Afgrening skal matche systemets nuværende luftmængde)</label>
                    <div class="input-field-group">
                        <div class="input-group"><label for="sys_tee_q_straight">q Ligeud</label><div class="input-unit-wrapper" data-unit="m³/h"><input type="text" id="sys_tee_q_straight" class="input-field"></div></div>
                        <div class="input-group"><label for="sys_tee_q_branch">q Afgrening</label><div class="input-unit-wrapper" data-unit="m³/h"><input type="text" id="sys_tee_q_branch" class="input-field"></div></div>
                    </div>
                </div>
                <div class="sub-group">
                    ${diameterInputs}
                </div>
                <div class="sub-group">
                    <label>Hvilken gren fortsætter systemet med?</label>
                    <div class="radio-group"> 
                        <input type="radio" id="sysTeePathStraight" name="sysTeePath" value="straight" checked><label for="sysTeePathStraight">Ligeud</label> 
                        <input type="radio" id="sysTeePathBranch" name="sysTeePath" value="branch"><label for="sysTeePathBranch">Afgrening</label> 
                    </div>
                </div>
            `;
            break;
    }
    container.innerHTML = inputsHtml + `<button type="submit" class="button primary">Tilføj til System</button>`;
}
        
function handleAddComponent(event) {
    event.preventDefault();
    const componentType = systemComponentTypeSelect.value;

    const airflow = parseLocalFloat(document.getElementById('system_airflow').value);
    const temp = parseLocalFloat(document.getElementById('temperature').value);
    if (isNaN(airflow) || isNaN(temp) || airflow <= 0) {
        alert('Udfyld venligst Start Luftmængde og global Temperatur korrekt.');
        return;
    }
    const { RHO, NU } = getAirProperties(temp);
    const Q = airflow / 3600;

    let newComponent = { id: Date.now(), airflow: airflow };

    try {
        if (componentType === 'straightDuct') {
            const length = parseLocalFloat(document.getElementById('ductLength').value);
            if (isNaN(length) || length <= 0) { alert('Udfyld venligst Længde korrekt.'); return; }
            
            const shape = document.querySelector('input[name="sysDuctShape"]:checked').value;
            let performance, name, details;

            if (shape === 'round') {
                const diameter = parseLocalFloat(document.getElementById('ductDiameter').value);
                performance = getPerformance(Q, diameter / 1000, { shape: 'round' }, RHO, NU);
                name = `Lige Kanal Ø${diameter}`;
                details = `${length}m`;
            } else {
                const sideA = parseLocalFloat(document.getElementById('ductSideA').value);
                const sideB = parseLocalFloat(document.getElementById('ductSideB').value);
                performance = getPerformance(Q, 0, { shape: 'rect', a: sideA, b: sideB }, RHO, NU);
                name = `Lige Kanal ${sideA}x${sideB}`;
                details = `${length}m`;
            }
            newComponent = { ...newComponent, type: 'straightDuct', name, details, velocity: performance.velocity, pressureLoss: performance.pressureDrop * length, calculationDetails: { ...performance, length: length, RHO: RHO } };

        } else if (componentType === 'manualLoss') {
            const name = document.getElementById('manualLossName').value || 'Manuelt Tab';
            const pressureLoss = parseLocalFloat(document.getElementById('manualLossValue').value);
            if (isNaN(pressureLoss)) { alert('Indtast venligst et gyldigt tryktab.'); return; }
            newComponent = { ...newComponent, type: 'manualLoss', name, details: '', velocity: null, pressureLoss: pressureLoss, calculationDetails: null };

        } else if (componentType === 'fitting') {
            const fittingType = document.getElementById('systemFittingType').value;
            if (!fittingType) { alert('Vælg venligst en type formstykke.'); return; }

            let name, details, velocity, pressureLoss, calculationDetails;
            let zeta, A, v, Pdyn_Pa;

            switch(fittingType) {
                // ... (Existing cases for bends and transitions remain here)
                case 'bend_circ':
                    const d = parseLocalFloat(document.getElementById('sys_d').value);
                    const angle = parseLocalFloat(document.getElementById('sys_angle').value);
                    const rd = parseLocalFloat(document.getElementById('sys_rd').value);
                    const rd_key = rd < 1.25 ? "rd1_0" : "rd1_5";
                    zeta = interpolateValue(angle, d, CIRCULAR_BEND_ZETA[rd_key]);
                    A = Math.PI * (getInternalDim(d)/2000)**2;
                    v = Q/A;
                    Pdyn_Pa = (RHO / 2) * v ** 2;
                    pressureLoss = zeta * Pdyn_Pa;
                    
                    name = `Bøjning Cirk. Ø${d}`;
                    details = `${angle}° R/d=${rd}`;
                    velocity = v;
                    calculationDetails = { type: fittingType, A_m2: A, v_ms: v, zeta: zeta, Pdyn_Pa: Pdyn_Pa };
                    break;
                case 'bend_rect':
                    // ... existing bend_rect logic
                    break;
                case 'expansion':
                    // ... existing expansion logic
                    break;
                case 'contraction':
                    // ... existing contraction logic
                    break;

                // --- ADDED T-PIECE LOGIC ---
                case 'tee_sym':
                case 'tee_asym':
                    const q_in = airflow; // Use system airflow as inlet flow
                    const q_straight = parseLocalFloat(document.getElementById('sys_tee_q_straight').value);
                    const q_branch = parseLocalFloat(document.getElementById('sys_tee_q_branch').value);
                    
                    if (Math.abs(q_in - (q_straight + q_branch)) > 1) {
                        alert("Luftmængderne for T-stykket stemmer ikke overens (Ligeud + Afgrening skal summere til systemets nuværende luftmængde)."); return;
                    }
                    
                    const isSymTee = fittingType === 'tee_sym';
                    const d_in = parseLocalFloat(document.getElementById('sys_tee_d_in').value);
                    const d_straight = isSymTee ? d_in : parseLocalFloat(document.getElementById('sys_tee_d_straight').value);
                    const d_branch = isSymTee ? d_in : parseLocalFloat(document.getElementById('sys_tee_d_branch').value);

                    const teeResults = calculateTeePressureLoss({q_in, q_straight, q_branch}, {d_in, d_straight, d_branch}, RHO);
                    
                    const chosenPath = document.querySelector('input[name="sysTeePath"]:checked').value;
                    let newAirflow;

                    if (chosenPath === 'straight') {
                        pressureLoss = teeResults.loss_straight;
                        velocity = teeResults.details_straight.v_ms;
                        calculationDetails = { ...teeResults.details_straight, type: fittingType, chosenPath: 'Ligeud' };
                        newAirflow = q_straight;
                        name = `T-stykke (Ligeud)`;
                        details = `q=${q_straight} m³/h`;
                    } else { // branch
                        pressureLoss = teeResults.loss_branch;
                        velocity = teeResults.details_branch.v_ms;
                        calculationDetails = { ...teeResults.details_branch, type: fittingType, chosenPath: 'Afgrening' };
                        newAirflow = q_branch;
                        name = `T-stykke (Afgrening)`;
                        details = `q=${q_branch} m³/h`;
                    }
                    
                    // Update the main airflow input for the next components
                    document.getElementById('system_airflow').value = formatLocalFloat(newAirflow, 0);

                    newComponent = { ...newComponent, type: fittingType, name, details, velocity, pressureLoss, calculationDetails };
                    break;

                default:
                     alert('Denne formstykke-type er endnu ikke implementeret.'); return;
            }
            newComponent = { ...newComponent, type: fittingType, name, details, velocity, pressureLoss, calculationDetails };
        }
    }
    catch (e) {
        alert('Fejl i input-felter. Kontroller venligst værdierne. Fejl: ' + e.message);
        return;
    }
    
    systemComponents.push(newComponent);
    renderSystem();
}


        
        function handleDeleteComponent(id) {
            systemComponents = systemComponents.filter(c => c.id !== id);
            renderSystem();
        }
        
function renderSystem() {
    systemComponentsContainer.innerHTML = '';
    totalPressureDropContainer.innerHTML = '';

    if (systemComponents.length === 0) {
        systemComponentsContainer.innerHTML = '<p style="text-align:center; color: var(--text-muted-color);">Systemet er tomt. Vælg en komponenttype for at begynde.</p>';
        return;
    }

    let totalPressureDrop = 0;
    const tableRows = systemComponents.map(c => {
        totalPressureDrop += c.pressureLoss;
        const velocityText = c.velocity ? `${formatLocalFloat(c.velocity, 2)} m/s` : 'N/A';
        // Add the details button if calculationDetails exist
        const detailsButton = c.calculationDetails 
            ? `<button class="details-btn" onclick="showSystemComponentDetails(${c.id})">ⓘ</button>`
            : '';

        return `
            <tr>
                <td>${c.name}<br><small>${c.details}</small></td>
                <td>${formatLocalFloat(c.airflow, 0)} m³/h</td>
                <td>${velocityText}</td>
                <td>${formatLocalFloat(c.pressureLoss, 2)} Pa</td>
                <td>
                    ${detailsButton}
                    <button class="delete-btn" onclick="handleDeleteComponent(${c.id})">&times;</button>
                </td>
            </tr>
        `;
    }).join('');

    systemComponentsContainer.innerHTML = `
        <table class="fittings-table">
            <thead>
                <tr>
                    <th>Komponent</th>
                    <th>Luftmængde</th>
                    <th>Hastighed</th>
                    <th>Tryktab</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                ${tableRows}
            </tbody>
        </table>
    `;

    totalPressureDropContainer.innerHTML = `
        <div class="result-card">
            <h3>Samlet Systemtryktab</h3>
            <p class="highlight">${formatLocalFloat(totalPressureDrop, 2)} Pa</p>
        </div>
    `;
}

function getSystemFormHtml() {
    return `
        <section>
            <h2>Systemberegning</h2>
            
            <div class="input-group">
                <label for="system_airflow">Start Luftmængde (anvendes for alle efterfølgende komponenter)</label>
                <div class="input-unit-wrapper" data-unit="m³/h">
                    <input type="text" id="system_airflow" class="input-field" required>
                </div>
            </div>

            <div id="systemComponentsContainer"></div>

            <div id="totalPressureDropContainer" class="results-container"></div>

            <h3 class="section-header">Tilføj Komponent</h3>
            <form id="systemAddComponentForm">
                <div class="input-field-group">
                    <div class="input-group">
                        <label for="systemComponentType">Komponenttype</label>
                        <select id="systemComponentType" class="input-field">
                            <option value="">-- Vælg type --</option>
                            <option value="straightDuct">Lige Kanal</option>
                            <option value="fitting">Formstykke</option>
                            <option value="manualLoss">Manuelt Tab</option>
                        </select>
                    </div>
                </div>
                <div id="systemComponentInputsContainer"></div>
            </form>
        </section>
    `;
}

function showSystemComponentDetails(id) {
    const component = systemComponents.find(c => c.id === id);
    if (!component || !component.calculationDetails) return;

    const data = component.calculationDetails;
    modalTitle.innerText = `Detaljer for ${component.name}`;

    if (component.type === 'straightDuct') {
        const dpPerMeter = data.pressureDrop;
        modalBody.innerHTML = `<p><strong>Beregning for Lige Kanal</strong></p><p><strong>Hydraulisk Diameter (Dₕ, intern):</strong> ${formatLocalFloat(data.D_hyd_int, 4)} m</p><p><strong>Hastighed (v):</strong> ${formatLocalFloat(data.velocity, 2)} m/s</p><p><strong>Reynolds Tal (Re):</strong> ${data.reynolds.toExponential(2).replace('.',',')}</p><p><strong>Friktionsfaktor (λ):</strong> ${formatLocalFloat(data.lambda, 4)}</p><hr><p><strong>Tryktab pr. meter (dp) =</strong> (λ / Dₕ) * (ρ/2) * v² = <strong>${formatLocalFloat(dpPerMeter, 2)} Pa/m</strong></p><p><strong>Samlet Tryktab =</strong> dp * Længde = ${formatLocalFloat(dpPerMeter, 2)} * ${data.length} = <strong>${formatLocalFloat(component.pressureLoss, 2)} Pa</strong></p>`;
    } 
    else if (data.type === 'bend_circ' || data.type === 'bend_rect' || data.type === 'expansion' || data.type === 'contraction') {
        modalBody.innerHTML = `<p><strong>Beregning for Formstykke</strong></p><p><strong>Areal (A, effektivt):</strong> ${formatLocalFloat(data.A_m2, 5)} m²</p><p><strong>Hastighed (v):</strong> ${formatLocalFloat(data.v_ms, 2)} m/s</p><p><strong>Zeta-værdi (ζ, interpoleret):</strong> ${formatLocalFloat(data.zeta, 3)}</p><p><strong>Dynamisk Tryk (Pₐᵧₙ):</strong> ${formatLocalFloat(data.Pdyn_Pa, 2)} Pa</p><hr><p><strong>Tryktab (Δp) =</strong> ζ * Pₐᵧₙ</p><p><strong>Δp =</strong> ${formatLocalFloat(data.zeta, 3)} * ${formatLocalFloat(data.Pdyn_Pa, 2)} = <strong>${formatLocalFloat(component.pressureLoss, 2)} Pa</strong></p>`;
    }
    else if (data.type === 'tee_sym' || data.type === 'tee_asym') {
         modalBody.innerHTML = `<p><strong>Beregning for T-stykke (${data.chosenPath})</strong></p><p><strong>Areal (A, i gren):</strong> ${formatLocalFloat(data.A_m2, 5)} m²</p><p><strong>Hastighed (v, i gren):</strong> ${formatLocalFloat(data.v_ms, 2)} m/s</p><p><strong>Zeta-værdi (ζ, dynamisk):</strong> ${formatLocalFloat(data.zeta, 3)}</p><p><strong>Dynamisk Tryk ved indløb (Pₐᵧₙ):</strong> ${formatLocalFloat(data.Pdyn_Pa, 2)} Pa</p><hr><p><strong>Tryktab (Δp) =</strong> ζ * Pₐᵧₙ</p><p><strong>Δp =</strong> ${formatLocalFloat(data.zeta, 3)} * ${formatLocalFloat(data.Pdyn_Pa, 2)} = <strong>${formatLocalFloat(component.pressureLoss, 2)} Pa</strong></p>`;
    }
    detailsModal.style.display = 'flex';
}
            
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
    
        <script>
          if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
              navigator.serviceWorker.register('/service-worker.js').then(registration => {
                console.log('ServiceWorker registration successful with scope: ', registration.scope);
              }, err => {
                console.log('ServiceWorker registration failed: ', err);
              });
            });
          }
        </script>
</body>
</html>
